Bootstrap: docker
From: continuumio/miniconda3:latest

%post
    conda install -c conda-forge numpy
    conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch
    conda install -c conda-forge cudnn nccl
    conda install -c conda-forge nipype

%files
    networks.py /recon/networks.py
    params.py /recon/params.py
    preprocess.py /recon/preprocess.py
    synthesize.py /recon/synthesize.py
    main.py /recon/main.py

%runscript
    python3 /recon/main.py $*
